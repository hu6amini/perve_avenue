self.onmessage=function(e){const dates=e.data;const monthMap={enero:"01",febrero:"02",marzo:"03",abril:"04",mayo:"05",junio:"06",julio:"07",agosto:"08",septiembre:"09",octubre:"10",noviembre:"11",diciembre:"12",Янв:"01",Фев:"02",Мар:"03",Апр:"04",Май:"05",Июн:"06",Июл:"07",Авг:"08",Сен:"09",Окт:"10",Ноя:"11",Дек:"12"};const parsed=dates.map((txt,index)=>{let d=txt.trim().replace(/^on:\s*/,'');let m;let f=null;if(m=/(\d{1,2})\/(\d{1,2})\/(\d{4}),\s*(\d{1,2}):(\d{2})\s*(AM|PM)/.exec(d)){let[,,mm,dd,yyyy,hh,mi,ap]=m;if(ap==="PM"&&hh<12)hh=parseInt(hh)+12;else if(ap==="AM"&&hh==="12")hh=0;f=`${yyyy}-${mm.padStart(2,"0")}-${dd.padStart(2,"0")}T${hh}:${mi}:00`;}else if(m=/(\d{1,2})\/(\d{1,2})\/(\d{4}),\s*(\d{2}):(\d{2})/.exec(d)){f=`${m[3]}-${m[2].padStart(2,"0")}-${m[1].padStart(2,"0")}T${m[4]}:${m[5]}:00`;}else if(m=/(\d{4})\/(\d{1,2})\/(\d{1,2})\s*(\d{2}):(\d{2})/.exec(d)){f=`${m[1]}-${m[2].padStart(2,"0")}-${m[3].padStart(2,"0")}T${m[4]}:${m[5]}:00`;}else if(m=/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/.exec(d)){f=d;}else if(m=/([A-Za-z]+),\s*(\d{1,2})\s([A-Za-z]+)\s(\d{4})\s(\d{2}):(\d{2}):(\d{2})/.exec(d)){f=`${m[4]}-${m[3]}-${m[2].padStart(2,"0")}T${m[5]}:${m[6]}:${m[7]}`;}else if(m=/(\d{1,2})\s([A-Za-z]+)\s(\d{4})/.exec(d)){let mon=monthMap[m[2].toLowerCase()]||"01";f=`${m[3]}-${mon}-${m[1].padStart(2,"0")}T00:00:00`;}else if(m=/(\d{4})年(\d{2})月(\d{2})日/.exec(d)){f=`${m[1]}-${m[2]}-${m[3]}T00:00:00`;}else if(m=/(\d{1,2})\s([А-Яа-я]+)\s(\d{4})/.exec(d)){let mon=monthMap[m[2]]||"01";f=`${m[3]}-${mon}-${m[1].padStart(2,"0")}T00:00:00`;}else if(m=/(\d{1,2})-(\p{L}{3})-(\d{2})\s*(\d{2}):(\d{2})/u.exec(d)){let mon=monthMap[m[2]]||"01";f=`20${m[3]}-${mon}-${m[1].padStart(2,"0")}T${m[4]}:${m[5]}:00`;}return{index,original:d,datetime:f};});self.postMessage(parsed);
