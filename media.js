//Image Async 
function addAsyncDecoding(){document.querySelectorAll("img").forEach(t=>{t.hasAttribute("decoding")||t.setAttribute("decoding","async"),t.hasAttribute("loading")||t.hasAttribute("data-src")||t.classList.contains("lazyload")||t.closest(".slick_carousel")||t.setAttribute("loading","lazy")}),document.querySelectorAll("iframe:not([loading])").forEach(t=>t.setAttribute("loading","lazy"))}let debounceTimeout;function debounceMutation(){clearTimeout(debounceTimeout),debounceTimeout=setTimeout(()=>{addAsyncDecoding()},200)}const imasyncObserver=new MutationObserver(debounceMutation);imasyncObserver.observe(document.body,{childList:!0,subtree:!0,attributes:!1,characterData:!1});
//Gallery
const postColors=document.querySelectorAll(".post .color");postColors.forEach(t=>{t.querySelectorAll('img:not(.emojione):not(.signature img):not([src^="https://img.forumfree.net/html/emoticons/new"]):not([src^="https://img.forumfree.net/html/mime_types"])').forEach(img=>{if(!(img.alt&&img.alt.startsWith(":")||"a"===img.parentNode.tagName.toLowerCase()&&img.src.startsWith("https://www.google.com/s2/favicons"))){const parent=img.parentNode;if("a"===parent.tagName.toLowerCase()){if(img.classList.contains("lazyload")&&img.hasAttribute("data-src"))parent.setAttribute("data-lightbox","gallery");else if(parent.href!==img.src){parent.setAttribute("href",img.src);parent.setAttribute("data-lightbox","gallery")}}else{const link=document.createElement("a");link.href=img.src||img.getAttribute("data-src");link.setAttribute("data-lightbox","gallery");parent.insertBefore(link,img);link.appendChild(img)}}}),lightGallery(t,{selector:'a[data-lightbox="gallery"]'})});document.addEventListener("lazyloaded",function(){lightGallery(document.querySelectorAll('.lz-container'),{selector:'a[data-lightbox="gallery"]'})});
//Youtube iframe
function replaceYouTubeFrames(){document.querySelectorAll('iframe[src*="youtube.com/embed/"]').forEach((function(e){var t=e.src.split("/").pop().split("?")[0],a=e.src.match(/[?&]start=([^&]*)/),l=a?a[1]:null;fetch("https://www.googleapis.com/youtube/v3/videos?part=snippet&id="+t+"&key=AIzaSyCFhniclB06-OF1kOeL6t0g-KF7_qYVslI").then((e=>e.json())).then((a=>{var r=a.items[0].snippet.title,o=a.items[0].snippet.thumbnails,s=o.maxres?o.maxres.url:o.standard?o.standard.url:o.medium?o.medium.url:"",i=document.createElement("img");i.src=s,i.width="560",i.height="315",i.alt="YouTube Video Thumbnail";var n=document.createElement("span");n.textContent=r;var c=document.createElement("button");c.className="ytp-button",c.setAttribute("aria-label","Play"),c.setAttribute("title","Play"),c.style.width="68px",c.style.height="48px",c.style.background="none",c.style.border="none",c.style.position="absolute",c.style.top="50%",c.style.left="50%",c.style.transform="translate(-50%, -50%)",c.innerHTML='<svg height="100%" version="1.1" viewBox="0 0 68 48" width="100%"><path class="ytp-large-play-button-bg" d="M66.52,7.74c-0.78-2.93-2.49-5.41-5.42-6.19C55.79,.13,34,0,34,0S12.21,.13,6.9,1.55 C3.97,2.33,2.27,4.81,1.48,7.74C0.06,13.05,0,24,0,24s0.06,10.95,1.48,16.26c0.78,2.93,2.49,5.41,5.42,6.19 C12.21,47.87,34,48,34,48s21.79-0.13,27.1-1.55c2.93-0.78,4.64-3.26,5.42-6.19C67.94,34.95,68,24,68,24S67.94,13.05,66.52,7.74z" fill="#f00"></path><path d="M 45,24 27,14 27,34" fill="#fff"></path></svg>';var p=document.createElement("div");p.className="res_tmb",p.appendChild(i),p.appendChild(n),p.appendChild(c),p.onclick=function(){var e=document.createElement("iframe");e.width="560",e.height="315",e.src="https://www.youtube.com/embed/"+t+"?autoplay=1",e.title="YouTube video player",e.frameborder="0",e.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",e.allowFullscreen="true",l&&(e.src+="&start="+l),p.parentNode.replaceChild(e,p)},e.parentNode.replaceChild(p,e)})).catch((e=>console.error(e)))}))}replaceYouTubeFrames();
//Pamedia
const videoPlatforms=["anchor.fm","bitchute.com","dailymotion.com","gfycat.com","drive.google.com","imgur.com","archive.org","sendvid.com","store.steampowered.com","streamable.com","tiktok.com","tumblr.com","vimeo.com","vk.com","youtube.com"];function isVideoIframe(e){if(!e.src)return!1;const a=videoPlatforms.some((a=>e.src.includes(a))),o=e.hasAttribute("allowfullscreen");return a||o}function wrapIframe(e){let a=e.parentElement;if(!(a&&a.classList&&a.classList.contains("pamedia")))if(a&&"DIV"===a.tagName){const e=document.createElement("div");e.className="pamedia",a.replaceWith(e),e.appendChild(a)}else{const a=document.createElement("div");a.className="pamedia",e.replaceWith(a),a.appendChild(e)}}function processIframes(){document.querySelectorAll("iframe").forEach((e=>{isVideoIframe(e)&&!e.closest(".pamedia")&&wrapIframe(e)}))}let lastMutationTime=0;const videoIframeObserver=new MutationObserver((e=>{const a=Date.now();a-lastMutationTime<100||(lastMutationTime=a,e.forEach((e=>{e.addedNodes.forEach((e=>{if("IFRAME"===e.tagName&&isVideoIframe(e))wrapIframe(e);else if(e.querySelectorAll){e.querySelectorAll("iframe").forEach((e=>{isVideoIframe(e)&&!e.closest(".pamedia")&&wrapIframe(e)}))}}))})))}));videoIframeObserver.observe(document.body,{childList:!0,subtree:!0}),processIframes();
//Image generator
function createCustomDialog(){const e=document.querySelector(".imgen-backdrop"),t=document.querySelector(".imgen"),n=document.querySelector(".imgen-alert");if(t){t.style.display="block",e.style.display="block",n.style.display="none";const a=t.querySelector("input");a&&a.focus()}else{const e=document.createElement("div");e.className="imgen",e.style.zIndex=9999;const t=document.createElement("div");t.className="imgen-backdrop",t.addEventListener("click",(()=>{e.style.display="none",t.style.display="none",document.querySelector(".imgen-alert").style.display="none",document.querySelector(".imgen input").value=""}));const n=document.createElement("div");n.className="header",n.innerHTML='<i class="fa-regular fa-image"></i> Generate Image Thumbnail',e.appendChild(n);const a=document.createElement("div");a.className="imgen-alert",a.innerHTML='<i class="fa-regular fa-circle-exclamation"></i> Please enter a valid URL',e.appendChild(a),a.style.display="none";const l=document.createElement("input");l.type="text",l.placeholder="Insert image link...",l.setAttribute("aria-label","Image URL"),e.appendChild(l);const c=document.createElement("button");c.className="codebuttons",c.textContent="INSERT",c.addEventListener("click",(()=>{const n=l.value;validateImageURL(n,(c=>{if(c){const a=new Image;a.onload=function(){const container=document.createElement("div");container.classList.add("lz-container"),container.setAttribute("width",a.width),container.setAttribute("height",a.height);const anchor=document.createElement("a");anchor.target="_blank",anchor.href=n;const img=document.createElement("img");img.className="color_img lazyload",img.setAttribute("data-src",n),img.setAttribute("decoding","async"),img.setAttribute("height",a.height),img.setAttribute("width",a.width),anchor.appendChild(img),container.appendChild(anchor),tag(container.outerHTML,""),triggerInputEvent(),e.style.display="none",t.style.display="none",l.value=""},a.src=n}else a.style.display="block"}))})),e.appendChild(c),c.setAttribute("aria-label","Insert"),l.addEventListener("click",(()=>{l.select()})),document.body.appendChild(t),document.body.appendChild(e),e.style.display="block",l.focus()}}function triggerInputEvent(){const e=document.querySelector("textarea#Post");if(e){const t=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(t)}}function validateImageURL(e,t){const n=new Image;n.src=e,n.onload=()=>{t(!0)},n.onerror=()=>t(!1)}function tag_image(){createCustomDialog()}if(document.URL.includes("?act=Post")||document.URL.includes("?t="));else{const e=document.querySelector('.codebuttons[value*="IMG"]');e&&e.addEventListener("click",tag_image)}
