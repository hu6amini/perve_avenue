//Post Avatars 
(function(){const AVATAR_COLORS=['#ff7770','#ff6b6b','#ff5154','#ffcb69','#fdc26d','#ffa96c','#ff9f1c','#ff8f5c','#9ce37d','#74c365','#16c172','#3ab795','#4ecdc4','#2dc7ff','#0eb1d2','#009bf5','#a3bcf9','#9b9ece','#9792e3','#8075ff','#b455b0','#a755c2','#a5acb5','#889696'];function getColorForCharacterCount(count){const rangeSize=Math.ceil(AVATAR_COLORS.length/26);return AVATAR_COLORS[Math.min(Math.floor(count/rangeSize),AVATAR_COLORS.length-1)];}function createAvatarSpan(userName,parentElement){const firstLetter=userName.charAt(0).toUpperCase(),avatarSpan=document.createElement('span');avatarSpan.className='avatar';avatarSpan.innerHTML=firstLetter;avatarSpan.style.backgroundColor=getColorForCharacterCount(userName.length);avatarSpan.style.color='#F7FFF7';parentElement.innerHTML='';parentElement.appendChild(avatarSpan);}function replaceAvatarsInPosts(){const posts=document.querySelectorAll('.post');posts.forEach(post=>{const avatarElement=post.querySelector('.left .avatar'),userLink=post.querySelector('.nick a'),userNickElement=post.querySelector('.nick');let userName;if(userLink){userName=userLink.textContent.trim();}else if(userNickElement){userName=userNickElement.innerHTML.trim();}if(avatarElement){const img=avatarElement.querySelector('img');if(img){const imgSrc=img.src,imgCheck=new Image();imgCheck.src=imgSrc;imgCheck.onload=function(){const defaultAvatarSrc="https://res.cloudinary.com/dbdf6gwgo/image/upload/v1674337715/forum/Avatar/default_avatar_zpw3zz.svg",robotAvatarSrc="https://res.cloudinary.com/dbdf6gwgo/image/upload/v1676109015/forum/Avatar/robot_snynw7.svg";if(imgSrc===defaultAvatarSrc||imgSrc===robotAvatarSrc){createAvatarSpan(userName,avatarElement);}};imgCheck.onerror=function(){createAvatarSpan(userName,avatarElement);};}else{createAvatarSpan(userName,avatarElement);}}else if(userName){const detailsElement=post.querySelector('.center .left .details');if(detailsElement&&!detailsElement.querySelector('.avatar')){const existingParagraph=detailsElement.querySelector('p'),existingNick=detailsElement.querySelector('.nick');createAvatarSpan(userName,detailsElement);if(existingParagraph)detailsElement.appendChild(existingParagraph);if(existingNick)detailsElement.appendChild(existingNick);}}});}replaceAvatarsInPosts();})();
//First Letter Avatars 
!function(){const e=["#ff7770","#ff6b6b","#ff5154","#ffcb69","#fdc26d","#ffa96c","#ff9f1c","#ff8f5c","#9ce37d","#74c365","#16c172","#3ab795","#4ecdc4","#2dc7ff","#0eb1d2","#009bf5","#a3bcf9","#9b9ece","#9792e3","#8075ff","#b455b0","#a755c2","#a5acb5","#889696"];function createAvatarLink(e,r){const t=e.charAt(0).toUpperCase(),o=document.createElement("a");o.href=r,o.className="avatar";const a=document.createElement("span");a.className="avatar",a.innerHTML=t;const n=getColorForCharacterCount(e.length);return a.style.backgroundColor=n,a.style.color="#F7FFF7",o.appendChild(a),o}function getColorForCharacterCount(r){const t=Math.ceil(1/e.length),o=Math.min(Math.floor(r/t),e.length-1);return e[o]}function fetchAvatarForUser(e,r){const t=e.href;fetch(t).then((e=>e.text())).then((o=>{const a=(new DOMParser).parseFromString(o,"text/html").querySelector(".profile .avatar img");if(a){const o="https://res.cloudinary.com/dbdf6gwgo/image/upload/v1674337715/forum/Avatar/default_avatar_zpw3zz.svg",n="https://res.cloudinary.com/dbdf6gwgo/image/upload/v1676109015/forum/Avatar/robot_snynw7.svg",c=new Image;c.src=a.src,c.onload=function(){if(a.src===o||a.src===n){const o=createAvatarLink(e.textContent.trim(),t);r.appendChild(o)}else{const e=document.createElement("a");e.href=t,e.className="avatar",e.appendChild(c),r.appendChild(e)}},c.onerror=function(){const o=createAvatarLink(e.textContent.trim(),t);r.appendChild(o)}}else{const o=createAvatarLink(e.textContent.trim(),t);r.appendChild(o)}})).catch((e=>console.error("Error fetching profile:",e)))}!function checkAndFetchAvatars(){document.querySelectorAll("#group .big_list li, #members .big_list li, .side_topics .thumbs a").forEach((e=>{const r=e.querySelector(".aa.thumbs a"),t=e.querySelector(".bb .nick a");if(r&&t){const e=new Image;e.src=r.querySelector("img")?.src||"",e.onload=function(){if(r.querySelector("img")&&("https://res.cloudinary.com/dbdf6gwgo/image/upload/v1674337715/forum/Avatar/default_avatar_zpw3zz.svg"===r.querySelector("img").src||"https://res.cloudinary.com/dbdf6gwgo/image/upload/v1676109015/forum/Avatar/robot_snynw7.svg"===r.querySelector("img").src)){const e=createAvatarLink(t.textContent.trim(),t.href);r.innerHTML="",r.appendChild(e)}},e.onerror=function(){const e=createAvatarLink(t.textContent.trim(),t.href);r.innerHTML="",r.appendChild(e)}}})),document.querySelectorAll(".side_topics .thumbs a").forEach((e=>{const r=e.closest(".side_topics").querySelector(".who a");if(e&&r){const t=new Image;t.src=e.querySelector("img")?.src||"",t.onload=function(){if(e.querySelector("img")&&("https://res.cloudinary.com/dbdf6gwgo/image/upload/v1674337715/forum/Avatar/default_avatar_zpw3zz.svg"===e.querySelector("img").src||"https://res.cloudinary.com/dbdf6gwgo/image/upload/v1676109015/forum/Avatar/robot_snynw7.svg"===e.querySelector("img").src)){const t=createAvatarLink(r.textContent.trim(),r.href);e.innerHTML="",e.appendChild(t)}},t.onerror=function(){const t=createAvatarLink(r.textContent.trim(),r.href);e.innerHTML="",e.appendChild(t)}}}))}(),document.querySelectorAll(".big_list .zz").forEach((e=>{const r=e.querySelector(".who");r&&fetchAvatarForUser(r.querySelector("a"),e)})),document.querySelectorAll(".stats.List .users a").forEach((e=>{fetchAvatarForUser(e,e)})),document.querySelectorAll("#tagObject li").forEach((e=>{const r=e.querySelector(".nickname");r&&fetchAvatarForUser(r,e)})),document.querySelectorAll("#send .summary .nick a").forEach((e=>{fetchAvatarForUser(e,e.parentElement)})),function replaceProfileAvatar(){const e=document.querySelector("#profile .profile span.nick"),r=document.querySelector("#profile .profile span.avatar");if(e&&r){const t=r.querySelector("img");if(!t||"https://res.cloudinary.com/dbdf6gwgo/image/upload/v1674337715/forum/Avatar/default_avatar_zpw3zz.svg"===t.src){const t=e.innerHTML.trim(),o=createAvatarLink(t,"#"),a=getColorForCharacterCount(t.length);o.querySelector("span").style.backgroundColor=a;const n=document.createElement("span");n.className="avatar",n.innerHTML=o.querySelector("span").innerHTML,n.style.backgroundColor=a,r.innerHTML="",r.appendChild(n)}}}(),function fetchAvatarForTopicSlider(){document.querySelectorAll(".topic_slider .thumbs a").forEach((e=>{const r=e.querySelector("img");if(r&&"https://res.cloudinary.com/dbdf6gwgo/image/upload/v1674337715/forum/Avatar/default_avatar_zpw3zz.svg"===r.src){const r=e.href;fetch(r).then((e=>e.text())).then((t=>{const o=(new DOMParser).parseFromString(t,"text/html").querySelector(".profile .nick");if(o){const t=createAvatarLink(o.innerHTML.trim(),r);e.innerHTML="",e.appendChild(t)}})).catch((e=>console.error("Error fetching topic slider avatar:",e)))}}))}(),function fetchAvatarForProfileFriends(){document.querySelectorAll(".profile-friends.thumbs a").forEach((e=>{const r=e.querySelector("img");if(r&&"https://res.cloudinary.com/dbdf6gwgo/image/upload/v1674337715/forum/Avatar/default_avatar_zpw3zz.svg"===r.src){const r=e.href;fetch(r).then((e=>e.text())).then((t=>{const o=(new DOMParser).parseFromString(t,"text/html").querySelector(".profile .nick");if(o){const t=createAvatarLink(o.textContent.trim(),r);e.innerHTML="",e.appendChild(t)}})).catch((e=>console.error("Error fetching profile for friends:",e)))}}))}()}();
//Avatar Pack 
!function(){const e=["#ff7770","#ff6b6b","#ff5154","#ffcb69","#fdc26d","#ffa96c","#ff9f1c","#ff8f5c","#9ce37d","#74c365","#16c172","#3ab795","#4ecdc4","#2dc7ff","#0eb1d2","#009bf5","#a3bcf9","#9b9ece","#9792e3","#8075ff","#b455b0","#a755c2","#a5acb5","#889696"];function createAvatar(t){const r=t.charAt(0).toUpperCase(),a=document.createElement("span");a.className="avatar",a.innerHTML=r;const o=function getColorForCharacterCount(t){const r=Math.ceil(e.length/26),a=Math.min(Math.floor(t/r),e.length-1);return e[a]}(t.length);return a.style.backgroundColor=o,a.style.color="#f7fff7bf",a}function handleAvatarReplacement(e,t,r){const a=new Image;a.src=e.src,a.onload=function(){if("https://res.cloudinary.com/dbdf6gwgo/image/upload/v1674337715/forum/Avatar/default_avatar_zpw3zz.svg"===e.src){const e=createAvatar(t);r.innerHTML="",r.appendChild(e)}},a.onerror=function(){const e=createAvatar(t);r.innerHTML="",r.appendChild(e)}}function replaceDefaultAvatars(){document.querySelectorAll("#notifications-modal .notification-row").forEach((e=>{const t=e.querySelector(".avatar img"),r=e.querySelector(".notification-text b");t&&r&&handleAvatarReplacement(t,r.textContent.trim(),e.querySelector(".avatar"))}))}function replaceProfileThumbsAvatars(){document.querySelectorAll("#pop_profile .thumbs a").forEach((e=>{const t=e.querySelector("img.default_avatar"),r=e.getAttribute("href");t&&"https://res.cloudinary.com/dbdf6gwgo/image/upload/v1674337715/forum/Avatar/default_avatar_zpw3zz.svg"===t.src&&fetch(r).then((e=>e.text())).then((r=>{const a=(new DOMParser).parseFromString(r,"text/html").querySelector(".profile .nick");if(a){const r=a.textContent.trim();handleAvatarReplacement(t,r,e)}})).catch((e=>console.error("Error fetching profile:",e)))}))}function handlePopupAvatars(){document.querySelectorAll(".popup.pop_points .users li a").forEach((e=>{const t=e.getAttribute("href");e.parentNode.querySelector(".avatar img");e.parentNode.querySelector(".avatar")||fetch(t).then((e=>e.text())).then((r=>{const a=(new DOMParser).parseFromString(r,"text/html"),o=a.querySelector(".profile .nick");if(o){const r=o.textContent.trim(),n=a.querySelector(".profile .avatar img");if(n){const a=new Image;a.src=n.src,a.onload=function(){const o=document.createElement("a");if(o.className="avatar",o.href=t,"https://res.cloudinary.com/dbdf6gwgo/image/upload/v1674337715/forum/Avatar/default_avatar_zpw3zz.svg"!==a.src){const e=a.cloneNode();o.appendChild(e)}else{const e=createAvatar(r);o.appendChild(e)}e.parentNode.querySelector(".avatar")||e.parentNode.insertBefore(o,e)},a.onerror=function(){const a=createAvatar(r),o=document.createElement("a");o.className="avatar",o.href=t,o.appendChild(a),e.parentNode.querySelector(".avatar")||e.parentNode.insertBefore(o,e)}}}})).catch((e=>console.error("Error fetching profile:",e)))}))}function waitForElement(e,t){const r=new MutationObserver((()=>{const a=document.querySelector(e);a&&(r.disconnect(),t(a))}));r.observe(document.body,{childList:!0,subtree:!0})}const t=new MutationObserver((()=>{replaceDefaultAvatars()}));waitForElement("#notifications-modal",(e=>{t.observe(e,{childList:!0,subtree:!0}),replaceDefaultAvatars()})),waitForElement("#pop_profile",(e=>{new MutationObserver((()=>{replaceProfileThumbsAvatars()})).observe(e,{childList:!0,subtree:!0}),replaceProfileThumbsAvatars()})),waitForElement(".popup.pop_points",(e=>{new MutationObserver((()=>{handlePopupAvatars()})).observe(e,{childList:!0,subtree:!0}),handlePopupAvatars()}))}();
//Avatar Pack 2 
!function(){const e=["#ff7770","#ff6b6b","#ff5154","#ffcb69","#fdc26d","#ffa96c","#ff9f1c","#ff8f5c","#9ce37d","#74c365","#16c172","#3ab795","#4ecdc4","#2dc7ff","#0eb1d2","#009bf5","#a3bcf9","#9b9ece","#9792e3","#8075ff","#b455b0","#a755c2","#a5acb5","#889696"];function createAvatar(t){const r=t.charAt(0).toUpperCase(),a=document.createElement("span");a.className="avatar",a.innerHTML=r;const n=function getColorForCharacterCount(t){const r=Math.ceil(e.length/26),a=Math.min(Math.floor(t/r),e.length-1);return e[a]}(t.length);return a.style.backgroundColor=n,a.style.color="#f7fff7bf",a}function handleAvatars(){const e=document.querySelectorAll('[id^="cs-modal-"] .st-emoji-user-list .st-emoji-user'),t="https://res.cloudinary.com/dbdf6gwgo/image/upload/v1674337715/forum/Avatar/default_avatar_zpw3zz.svg";e.forEach((e=>{const r=e.querySelector(".st-emoji-user-avatar a"),a=e.querySelector(".st-emoji-user-nick a");if(r){const e=r.querySelector("img");if(e){const n=new Image;n.src=e.src,n.onload=function(){if(e.src===t&&a){const e=createAvatar(a.textContent.trim());r.innerHTML="",r.appendChild(e)}},n.onerror=function(){if(a){const e=createAvatar(a.textContent.trim());r.innerHTML="",r.appendChild(e)}}}else console.error("Image element not found within avatar link.")}}));const r=document.querySelectorAll("#markdiv .list-users div");r.forEach((e=>{const r=e.querySelector("img"),a=e.querySelector("mark"),n=a.textContent.trim();if(r){const o=new Image;o.src=r.src,o.onload=function(){if(0!==r.naturalWidth&&r.src!==t&&"https://img.forumfree.net/style_images/default_avatar.png"!==r.src)return;const o=createAvatar(n);e.innerHTML="",e.appendChild(o),e.appendChild(a.cloneNode(!0))},o.onerror=function(){const t=createAvatar(n);e.innerHTML="",e.appendChild(t),e.appendChild(a.cloneNode(!0))}}else console.error("Image element not found within user div.")}));document.querySelectorAll(".atwho-view-ul li").forEach((e=>{const t=e.querySelector("img"),r=e.getAttribute("data-name")||e.textContent.trim(),a=t?t.src:null;if("https://res.cloudinary.com/dbdf6gwgo/image/upload/v1674337715/forum/Avatar/default_avatar_zpw3zz.svg"===a){if(!e.hasAttribute("data-avatar-created")){const t=createAvatar(r);e.innerHTML="",e.appendChild(t),e.innerHTML+=r,e.setAttribute("data-avatar-created","true")}}else if(a){const t=new Image;t.src=a,t.onload=function(){},t.onerror=function(){if(!e.hasAttribute("data-avatar-created")){const t=createAvatar(r),a=e.innerHTML;e.innerHTML="",e.appendChild(t),e.innerHTML+=a,e.setAttribute("data-avatar-created","true")}}}else if(!e.hasAttribute("data-avatar-created")){const t=createAvatar(r),a=e.innerHTML;e.innerHTML="",e.appendChild(t),e.innerHTML+=a,e.setAttribute("data-avatar-created","true")}}));document.querySelectorAll(".ve-dropdown-list.ve-mention-list li").forEach((e=>{const t=e.querySelector("img");let r=e.querySelector(".ve-mention-label").textContent.trim();const a=t?t.src:null;if(r.includes("gruppo: ")&&(r=r.replace("gruppo: ","").trim()),t){if("https://res.cloudinary.com/dbdf6gwgo/image/upload/v1674337715/forum/Avatar/default_avatar_zpw3zz.svg"===a&&!e.hasAttribute("data-avatar-created")){const a=createAvatar(r);t.parentNode.replaceChild(a,t),e.setAttribute("data-avatar-created","true")}}else if(!e.hasAttribute("data-avatar-created")){const t=createAvatar(r),a=e.querySelector(".ve-mention-label");a.innerHTML="",a.appendChild(t),a.innerHTML+=r,e.setAttribute("data-avatar-created","true")}}));const a=document.querySelectorAll(".cs-modal .st-emoji-notice-item");a.forEach((e=>{const t=e.querySelector("a.st-emoji-notice-avatar");if(t){const e=t.querySelector("img");if(e&&("https://res.cloudinary.com/dbdf6gwgo/image/upload/v1674337715/forum/Avatar/default_avatar_zpw3zz.svg"===e.src||0===e.naturalWidth)){const e=t.href;fetch(e).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.text()})).then((r=>{const a=(new DOMParser).parseFromString(r,"text/html").querySelector(".profile .nick");if(a){const r=createAvatar(a.innerHTML.trim()),n=document.createElement("a");n.className="avatar",n.href=e,n.appendChild(r),t.parentNode.replaceChild(n,t)}})).catch((e=>console.error("Failed to fetch profile:",e)))}}}))}function waitForElement(e,t){const r=new MutationObserver((()=>{const a=document.querySelector(e);a&&(r.disconnect(),t(a))}));r.observe(document.body,{childList:!0,subtree:!0})}new MutationObserver((()=>{document.querySelectorAll('[id^="cs-modal-"]').forEach((e=>{handleAvatars()}))})).observe(document.body,{childList:!0,subtree:!0}),handleAvatars(),waitForElement("#markdiv .list-users",(()=>{handleAvatars();new MutationObserver((()=>{handleAvatars()})).observe(document.querySelector("#markdiv .list-users"),{childList:!0,subtree:!0})})),waitForElement(".atwho-view-ul",(()=>{handleAvatars();new MutationObserver((()=>{handleAvatars()})).observe(document.querySelector(".atwho-view-ul"),{childList:!0,subtree:!0})})),waitForElement(".cs-modal .st-emoji-notice-item",(()=>{handleAvatars();new MutationObserver((()=>{handleAvatars()})).observe(document.querySelector(".cs-modal"),{childList:!0,subtree:!0})})),waitForElement(".ve-dropdown-list.ve-mention-list",(()=>{handleAvatars();new MutationObserver((()=>{handleAvatars()})).observe(document.querySelector(".ve-dropdown-list.ve-mention-list"),{childList:!0,subtree:!0})}))}();
