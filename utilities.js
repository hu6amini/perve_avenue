//Quote - non blocking 
function isInsideVeContentColor(e){return e.closest(".ve-content.color")!==null}function debounce(e,t){let n;return function(...i){clearTimeout(n),n=setTimeout(()=>e.apply(this,i),t)}}function expandQuotes(e){if(!isInsideVeContentColor(e)){const t=()=>{const n=e.querySelector(".quotebtn button");if(!n&&e.scrollHeight>170){e.style.maxHeight="170px",e.style.overflow="hidden";const i=document.createElement("div");i.className="quotebtn";const o=document.createElement("button");o.textContent="Show More...",i.appendChild(o),e.appendChild(i),o.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),e.style.transition="max-height 0.382s ease-in-out",e.style.maxHeight=e.scrollHeight+"px",i.style.display="none",setTimeout(()=>{e.style.maxHeight="none"},382)})}else n&&e.scrollHeight<=170&&(n.parentNode.remove(),e.style.maxHeight="none")};t(),resizeObserver.observe(e);const n=e.querySelector(".spoiler .code_top a");n&&n.addEventListener("click",()=>{e.style.maxHeight="none",resizeObserver.unobserve(e)})}}const resizeObserver=new ResizeObserver(debounce(e=>{e.forEach(e=>expandQuotes(e.target))},100)),quotes=document.querySelectorAll(".post .quote, #loading .quote");for(let e=0;e<quotes.length;e++)expandQuotes(quotes[e]);const quoteObserver=new MutationObserver(e=>{for(const t of e)for(const n of t.addedNodes)n.nodeType===Node.ELEMENT_NODE&&(n.matches(".quote")?expandQuotes(n):n.querySelectorAll(".quote").forEach(e=>expandQuotes(e)))});quoteObserver.observe(document.body,{childList:!0,subtree:!0});function modifyQuoteTop(e){if(!isInsideVeContentColor(e)){const t=e.textContent,n=e.querySelector("a");if(t.includes("@")){const i=t.replace(/(.*)\s*\(([^@]+)@[^)]+\)\s*/,"$2 said:");e.innerHTML=i,e.style.color="var(--mdcol)",n&&(e.appendChild(n),n.style.color="var(--mdcol)")}else{const t=e.querySelector(".quote_top b");t&&(t.style.opacity=1)}}}const quoteTops=document.querySelectorAll(".post .quote_top, #loading .quote_top");for(let e=0;e<quoteTops.length;e++)modifyQuoteTop(quoteTops[e]);const quoteTopObserver=new MutationObserver(e=>{for(const t of e)for(const n of t.addedNodes)n.nodeType===Node.ELEMENT_NODE&&n.querySelectorAll(".quote_top").forEach(e=>modifyQuoteTop(e))});quoteTopObserver.observe(document.body,{childList:!0,subtree:!0});
//Skin
const root=document.documentElement,button=document.getElementById("theme-toggle-button");button.addEventListener("click",(()=>{"second"===root.getAttribute("data-theme")?(root.removeAttribute("data-theme"),localStorage.removeItem(storageKey)):(root.setAttribute("data-theme","second"),localStorage.setItem(storageKey,"second"))}));
//Profile Tooltips
