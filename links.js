//Favicons
(()=>{function e(e){e.forEach((e=>{if(!(e.closest(".spoiler .code_top a")||e.closest(".fancyborder a")||e.closest(".quote_top a")||e.closest(".ve-content [data-type=mention]")||e.querySelector("img"))){var o=e.href.includes("youtu.be")?"https://www.google.com/s2/favicons?domain=youtube.com":"https://www.google.com/s2/favicons?domain="+e.href;e.style.backgroundImage="url('"+o+"')",e.style.backgroundSize="16px 16px",e.style.backgroundPosition="left center",e.style.backgroundRepeat="no-repeat",e.style.paddingLeft="19px",e.matches(".quote a, .tmsg a")&&(e.style.backgroundSize="14px 14px",e.style.paddingLeft="17px")}}))}e(document.querySelectorAll(".color a, span.tmsg a"));const o=new MutationObserver((o=>{o.forEach((o=>{e(o.target.querySelectorAll(".color a, span.tmsg a"))}))}));o.observe(document.body,{childList:!0,subtree:!0});})();
//Link generator
(()=>{let e;function n(){const t=document.querySelector(".linkgen"),n=document.querySelector(".linkgen-backdrop"),o=document.querySelector(".linkgen-alert");if(t)t.style.display="block",n.style.display="block",o.style.display="none",e.value="",e.focus();else{const t=document.createElement("div");t.className="linkgen",t.style.zIndex=9999;const o=document.createElement("div");o.className="header",o.innerHTML='<i class="fa-regular fa-link"></i> Generate Link',t.appendChild(o);const r=document.createElement("div");r.className="linkgen-alert",r.innerHTML='<i class="fa-regular fa-circle-exclamation"></i> Please enter a valid URL',r.style.display="none";const i=document.createElement("div");i.className="linkgen-backdrop",i.addEventListener("click",function(){t.style.display="none",i.style.display="none",e.value="",l.value="",r.style.display="none"}),e=document.createElement("input"),e.type="text",e.placeholder="Insert link...",e.setAttribute("aria-label","URL"),e.addEventListener("click",function(){e.value&&e.select()});const l=document.createElement("input");l.type="text",l.placeholder="Custom text...",l.setAttribute("aria-label","Custom Text");const c=document.createElement("button");c.className="codebuttons",c.textContent="INSERT",c.addEventListener("click",function(){const n=e.value,l=l.value;if(isValidURL(n)&&!containsHTMLorBBCode(n)){let t="";t=l?'<a target="_blank" href="'+n+'">'+l+"</a>":'<a target="_blank" href="'+n+'">'+n+"</a>",tag(t,""),triggerInputEvent(),t.style.display="none",i.style.display="none",e.value="",l.value=""}else r.style.display="block"})),t.appendChild(r),t.appendChild(e),t.appendChild(l),t.appendChild(c),document.body.appendChild(t),document.body.appendChild(i),t.style.display="block",e.focus()}}function triggerInputEvent(){const e=document.querySelector("textarea#Post");if(e){const t=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(t)}}function isValidURL(e){return/^https?:\/\/|^ftp:\/\//.test(e)}function containsHTMLorBBCode(e){return/<[^>]+>|\[.*?\]/.test(e)}const o=document.querySelector('input[accesskey="w"]');o&&(o.removeAttribute("onclick"),o.addEventListener("click",function(){n()}))})();
